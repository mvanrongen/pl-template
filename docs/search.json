[{},{"path":"index.html","id":"overview","chapter":"1 Overview","heading":"1 Overview","text":"sessions intended enable perform core data analysis techniques appropriately confidently using R.6 lecture-practicals6 lecture-practicalsOngoing formative assessment exercisesOngoing formative assessment exercisesNo formal assessmentNo formal assessmentNo mathematical derivationsNo mathematical derivationsNo pen paper calculationsNo pen paper calculationsThey “mindlessly use stats program” course!","code":""},{"path":"index.html","id":"core-aims","chapter":"1 Overview","heading":"1.1 Core aims","text":"know presented arbitrary dataset e.g.Know data analysis techniques availableKnow ones allowableBe able carry understand results","code":""},{"path":"index.html","id":"core-topics","chapter":"1 Overview","heading":"1.2 Core topics","text":"Simple Hypothesis TestingCategorical Predictor VariablesContinuous PredictorsMultiple Predictor VariablesLinear ModelsErrors, Power Multiple Comparisons","code":""},{"path":"index.html","id":"index-datasets","chapter":"1 Overview","heading":"1.3 Datasets","text":"course uses various data sets. easiest way accessing creating R-project RStudio. download data folder copy working directory. data accessible via <working-directory-name>/data/raw.","code":""},{},{"path":"cs1-intro.html","id":"cs1-intro","chapter":"2 Introduction","heading":"2 Introduction","text":"","code":""},{"path":"cs1-intro.html","id":"objectives","chapter":"2 Introduction","heading":"2.1 Objectives","text":"Aim: carry basic one two sample statistical tests.end section practical participants able achieve following listed tests:Understand purpose test isPerform test RInterpret test outputUnderstand assumptions/conditions test appropriateCheck assumptionsThe tests covered practical :One-sample tests\nOne sample t-test\nOne-sample Wilcoxon signed-rank test\nOne sample t-testOne-sample Wilcoxon signed-rank testTwo-sample tests\nStudent’s t-test\nMann-Whitney U test\nPaired two-sample t-test\nWilcoxon signed-rank test\nStudent’s t-testMann-Whitney U testPaired two-sample t-testWilcoxon signed-rank test","code":""},{"path":"cs1-intro.html","id":"background","chapter":"2 Introduction","heading":"2.2 Background","text":"practical focus underlying mathematical theory tests although demonstrators happy answer questions.\ntest section explaining purpose, section explaining perform test R, section explaining results output screen, section covering assumptions required perform test.","code":""},{},{"path":"cs2-intro.html","id":"cs2-intro","chapter":"3 Introduction","heading":"3 Introduction","text":"","code":""},{"path":"cs2-intro.html","id":"objectives-1","chapter":"3 Introduction","heading":"3.1 Objectives","text":"Aim: introduce R commands analysing single categorical predictors.end practical participants able perform following statistical analyses:One-way Analysis Variance (ANOVA)Kruskal-Wallis testFor , participants able :Perform test RInterpret outputCheck assumptions testCarry post-hoc test appropriateThe tests covered practical :One-way ANOVAKruskall-Wallis test","code":""},{"path":"cs2-intro.html","id":"background-1","chapter":"3 Introduction","heading":"3.2 Background","text":"practical focuses implementation various statistical tests relating categorical predictors. boil ANOVA Kruskal-Wallis (non-parametric alternative).\n, focus underlying theory tests (although demonstrators happy answer questions may ).test section :explains purpose test,explains visualise data,explains perform test R,explains interpret output report results, andexplains assess assumptions required perform test.","code":""},{},{"path":"cs2-anova.html","id":"cs2-anova","chapter":"4 ANOVA","heading":"4 ANOVA","text":"","code":""},{"path":"cs2-anova.html","id":"objectives-2","chapter":"4 ANOVA","heading":"4.1 Objectives","text":"QuestionsHow ……ObjectivesBe able …Use…","code":""},{"path":"cs2-anova.html","id":"purpose-and-aim","chapter":"4 ANOVA","heading":"4.2 Purpose and aim","text":"Analysis variance ANOVA test can used multiple samples continuous data. Whilst possible use ANOVA two samples, generally used three groups. used find samples came parent distributions mean. can thought generalisation two-sample Student’s t-test.","code":""},{"path":"cs2-anova.html","id":"section-commands","chapter":"4 ANOVA","heading":"4.3 Section commands","text":"New commands used section.","code":""},{"path":"cs2-anova.html","id":"data-and-hypotheses","chapter":"4 ANOVA","heading":"4.4 Data and hypotheses","text":"example, suppose measure feeding rate oyster catchers (shellfish per hour) three sites characterised degree shelter wind, imaginatively called exposed (E), partially sheltered (P) sheltered (S). want test whether data support hypothesis feeding rates don’t differ locations. form following null alternative hypotheses:\\(H_0\\): mean feeding rates three sites \\(\\mu E = \\mu P = \\mu S\\)\\(H_1\\): mean feeding rates equal.use one-way ANOVA test check .use one-way ANOVA test one predictor variable (categorical variable location).’re using ANOVA two groups don’t know better yet respect exact assumptions.data stored file CS2-oystercatcher.csv.","code":""},{"path":"cs2-anova.html","id":"summarise-and-visualise","chapter":"4 ANOVA","heading":"4.5 Summarise and visualise","text":"First read data.Next summarise data visualise . quick peek first rows data head() can see data organised.data stacked format. first column contains information feeding rates called feeding. second column categorical data type site called site.Looking data, appears noticeable difference feeding rates three sites. probably expect reasonably significant statistical result .","code":"\noystercatcher <- read.csv(\"data/raw/CS2-oystercatcher.csv\")\nhead(oystercatcher)##   feeding    site\n## 1    14.2 Exposed\n## 2    16.5 Exposed\n## 3     9.3 Exposed\n## 4    15.1 Exposed\n## 5    13.4 Exposed\n## 6    18.4 Partial\naggregate(feeding ~ site, data = oystercatcher, summary)##        site feeding.Min. feeding.1st Qu. feeding.Median feeding.Mean\n## 1   Exposed         9.30           13.40          14.20        13.70\n## 2   Partial        13.00           16.50          17.40        17.14\n## 3 Sheltered        21.50           22.20          24.10        23.64\n##   feeding.3rd Qu. feeding.Max.\n## 1           15.10        16.50\n## 2           18.40        20.40\n## 3           25.10        25.30\nboxplot(feeding ~ site, data = oystercatcher)"},{"path":"cs2-anova.html","id":"implement-test","chapter":"4 ANOVA","heading":"4.6 Implement test","text":"Perform ANOVA test data:first line fits linear model data (.e. finds means three groups calculates load intermediary data need statistical analysis) stores information R object (’ve called lm_oystercatchers, can call like). second line actually carries ANOVA analysis.first argument must formula format: response ~ predictorIf data stored stacked format, second argument must name data frameThe anova() command takes linear model object main argument","code":"\nlm_oystercatcher <- lm(feeding ~ site, data = oystercatcher)\n\nanova(lm_oystercatcher)"},{"path":"cs2-anova.html","id":"interpret-output-and-report-results","chapter":"4 ANOVA","heading":"4.7 Interpret output and report results","text":"output now see console window:1st line just tells ANOVA testThe 2nd line tells response variable (case feeding)3rd, 4th 5th lines ANOVA table contain useful values:\nDf column contains degrees freedom values row, 2 12 (’ll need reporting)\nF value column contains F statistic, 21.508 (’ll need reporting).\np-value 0.0001077 number directly Pr(>F) 4th line.\nvalues table (Sum Sq Mean Sq) columns used calculate F statistic don’t need know .\nDf column contains degrees freedom values row, 2 12 (’ll need reporting)F value column contains F statistic, 21.508 (’ll need reporting).p-value 0.0001077 number directly Pr(>F) 4th line.values table (Sum Sq Mean Sq) columns used calculate F statistic don’t need know .6th line symbolic codes represent big (small) p-value ; , p-value smaller 0.001 *** symbol next (). Whereas p-value 0.01 0.05 simply * character next , etc. Thankfully can cope actual numbers don’t need short-hand code determine reporting experiments (please tell ’s true…!), p-value ’re interested shows us probability getting samples null hypothesis actually true.Since p-value small (much smaller standard significance level 0.05) can say “unlikely three samples came parent distribution” can reject null hypothesis state :one-way ANOVA showed mean feeding rate oystercatchers differed significantly locations (F = 21.51, df = 2, 12, p = 0.00011).Note included (brackets) information test statistic (F = 21.51), degrees freedom (df = 2, 12), p-value (p = 0.00011).","code":"## Analysis of Variance Table\n## \n## Response: feeding\n##           Df  Sum Sq Mean Sq F value    Pr(>F)    \n## site       2 254.812 127.406  21.508 0.0001077 ***\n## Residuals 12  71.084   5.924                      \n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"},{"path":"cs2-anova.html","id":"assumptions","chapter":"4 ANOVA","heading":"4.8 Assumptions","text":"use ANOVA test, make three assumptions:parent distributions samples taken normally distributedEach data point samples independent othersThe parent distributions varianceIn similar way two-sample tests consider normality equality variance assumptions using tests graphical inspection (ignore independence assumption).1. NormalityUnstack data perform Shapiro-Wilk test group separately.output now see console window:can see three groups appear normally distributed good.ANOVA however, considering group turn often considered quite excessive , cases, sufficient consider normality combined set residuals data. ’ll explain residuals properly next session effectively difference data point group mean. residuals can obtained directly linear model fitted earlier.Extract residuals data check normality:, can see combined residuals three groups appear normally distributed (expected given normally distributed individually!)2. Equality VarianceWe now test equality variance using Bartlett’s test (since ’ve just found individual groups normally distributed).Perform Bartlett’s test data:relevant p-value given 3rd line. see group appear variance.3. Graphical Interpretation Diagnostic PlotsR provides convenient set graphs allow us assess assumptions graphically. simply ask R plot lm object created, can see diagnostic plots.Create standard set diagnostic plots:second line creates three diagnostic plots (actually tries create four plots can’t dataset ’ll also see warning text output screen (something hat values). ’ll go next session ’s easier explain).example, two plots (top-left bottom-left) show effectively thing: distribution data group look like. allow informal check equality variance assumption.\ntop-left graph want data symmetric 0 horizontal line spread (please ignore red line; unhelpful addition graphs).\nbottom-left graph, look red line want approximately horizontal.\ntop-left graph want data symmetric 0 horizontal line spread (please ignore red line; unhelpful addition graphs).bottom-left graph, look red line want approximately horizontal.top-right graph familiar Q-Q plot used previously assess normality, looks combined residuals groups (much way looked Shapiro-Wilk test combined residuals).can see graphs much line ’ve just looked using test, reassuring. groups appear spread data, whilst QQ-plot isn’t perfect, appears assumption normality allright.stage, point nearly always stick graphical method assessing assumptions test. Assumptions rarely either completely met met always degree personal assessment.Whilst formal statistical tests (like Shapiro) technically fine, can often create false sense things absolutely right wrong spite fact still probabilistic statistical tests. exercises using approaches whilst gain confidence experience interpreting graphical output whilst absolutely fine use future strongly recommend don’t rely solely statistical tests isolation.","code":"\nuns_oyster <- unstack(oystercatcher)\n\nshapiro.test(uns_oyster$Exposed)\nshapiro.test(uns_oyster$Partial)\nshapiro.test(uns_oyster$Sheltered)## \n##  Shapiro-Wilk normality test\n## \n## data:  uns_oyster$Exposed\n## W = 0.9151, p-value = 0.4988## \n##  Shapiro-Wilk normality test\n## \n## data:  uns_oyster$Partial\n## W = 0.96913, p-value = 0.8697## \n##  Shapiro-Wilk normality test\n## \n## data:  uns_oyster$Sheltered\n## W = 0.88532, p-value = 0.3341\nresid_oyster <- residuals(lm_oystercatcher)\n\nshapiro.test(resid_oyster)## \n##  Shapiro-Wilk normality test\n## \n## data:  resid_oyster\n## W = 0.93592, p-value = 0.3338\nbartlett.test(feeding ~ site, data = oystercatcher)## \n##  Bartlett test of homogeneity of variances\n## \n## data:  feeding by site\n## Bartlett's K-squared = 0.90632, df = 2, p-value = 0.6356\n# create a neat 2x2 window\npar(mfrow = c(2,2))\n# create the diagnostic plots\nplot(lm_oystercatcher)\n# and return the window back to normal\npar(mfrow = c(1,1))## hat values (leverages) are all = 0.2\n##  and there are no factor predictors; no plot no. 5"},{"path":"cs2-anova.html","id":"post-hoc-testing","chapter":"4 ANOVA","heading":"4.9 Post-hoc testing","text":"One drawback using ANOVA test tests see means , get significant result using ANOVA can say means , rather anything pairs groups differ. example, consider following boxplot three samples.group random sample 20 points normal distribution variance 1. Groups 1 2 come parent population mean 0 whereas group 3 come parent population mean 2. data clearly satisfy assumptions ANOVA test.1. Read data plot2. Test significant difference group meansHere p-value 2.39x10-7 test conclusively rejected hypothesis means equal.However, due sample means different, rather just one groups different others. order drill investigate use new test called Tukey’s range test (Tukey’s honest significant difference test – always makes think terrible cowboy/western dialogue). compare groups pairwise fashion reports whether significant difference exists.3. Performing Tukey’s test dataThe first argument repeats ANOVA using different function ‘aov().’ store output function R object called aov_tukey.\nNote TukeyHSD() function takes output aov() function argument raw data.bottom three lines contain information want. final column (entitled p adj) p-value ’re looking . null hypothesis case difference mean two groups. can see first line shows isn’t significant difference sample1 sample2 2nd 3rd lines show significant difference sample1 sample3, well sample2 sample3. matches expected based boxplot.4. AssumptionsWhen use Tukey’s range test matter debate (strangely enough lot statistical analysis techniques currently matters opinion rather mathematical fact – explain little whole field appears bloody confusing!)people claim perform Tukey’s range test (post-hoc tests) preceding ANOVA test showed significant difference groups ANOVA test shown significant differences groups stop .people say rubbish can hell like, like long tell people .background rather involved one reasons debate prevent -called data-dredging p-hacking. scientists/analysts fixated getting “significant” result perform huge variety statistical techniques find one shows data significant (particular problem psychological studies – point fingers though, working hard sort stuff . Kudos!).Whether use post-hoc testing depend experimental design questions ’re attempting answer.Tukey’s range test, decide use , requires three assumptions ANOVA test:Normality distributionsEquality variance groupsIndependence observations","code":"\ntukey <- read.csv(\"data/raw/CS2-tukey.csv\")\nboxplot(response ~ group, data = tukey)\nlm_tukey <- lm(response ~ group, data = tukey)\n\nanova(lm_tukey)## Analysis of Variance Table\n## \n## Response: response\n##           Df Sum Sq Mean Sq F value    Pr(>F)    \n## group      2 33.850 16.9250   20.16 2.392e-07 ***\n## Residuals 57 47.854  0.8395                      \n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\naov_tukey <- aov(response ~ group, data = tukey)\n\nTukeyHSD(aov_tukey)##   Tukey multiple comparisons of means\n##     95% family-wise confidence level\n## \n## Fit: aov(formula = response ~ group, data = tukey)\n## \n## $group\n##                      diff        lwr      upr     p adj\n## sample2-sample1 0.3037563 -0.3934982 1.001011 0.5498005\n## sample3-sample1 1.7233591  1.0261047 2.420614 0.0000005\n## sample3-sample2 1.4196028  0.7223484 2.116857 0.0000246"},{"path":"cs2-anova.html","id":"exercise","chapter":"4 ANOVA","heading":"4.10 Exercise","text":"Exercise 4.1  Juvenile lobster weightJuvenile lobsters aquaculture grown three different diets (fresh mussels, semi-dry pellets dry flakes). nine weeks, wet weight :evidence diet affects growth rate lobsters?Write null alternative hypothesesImport data R\ndata stored file data/raw/CS2-lobsters.csv\ndata stored file data/raw/CS2-lobsters.csvSummarise visualise dataCheck assumptions using appropriate tests graphical analysesPerform ANOVA testWrite sentence summarise results foundPerform post-hoc test report findings1. Hypotheses\\(H_0\\) : means equal\\(H_1\\) : means equal2-3. Import Data, summarise visualiseThe data stored .csv file stacked format columns called weight diet.Let’s look data see can see.always use plot summary assess three things:load data properly?see three groups reasonable values. aren’t data points obviously wrong (negative, zero massively big) right number groups. looks didn’t anything obviously wrong.expect result statistical test?Whilst Mussels group look higher two groups, Pellets Flakes appear almost identical terms average values, ’s quite bit overlap Mussels group. non-significant result likely answer, surprised see significant p-value - especially given small sample size .think assumptions?groups appear mainly symmetric (although Pellets bit weird) ’re immediately massively worried lack normality. , Flakes Mussels appear similar variances ’s bit hard decide ’s going Pellets. ’s hard say ’s going assumptions ’ll wait see tests say.4. Explore AssumptionsNormalityWe’ll really thorough consider normality group separately jointly using Shapiro-Wilk test, well looking Q-Q plot. reality, examples , ’ll use Q-Q plot.’ll need unstack data use Shapiro-Wilk test individual groups:Flakes Mussels fine, , suspected earlier, Pellets appears marginally significant Normality test result.Let’s look Shapiro-Wilk test data together:hand says everything fine. Let’s look Q-Q-plot:, ’ve used extra argument normal diagnostic plots call. default option plot 4 diagnostic plots, can tell R plot specific one. (want know look plot.lm help documentation using ?plot.lm). ’ve asked R plot Q-Q plot = 2 argument.Q-Q plot looks OK, perfect, good enough us confidence normality data.Overall, ’d happy assumption normality adequately well met . suggested lack normality Pellets just significant take account 5 data points group. lot points group, Q-Q plot considerably worse wouldn’t confident.Equality VarianceWe’ll consider Bartlett test ’ll look diagnostic plots .code, ’ve used trick argument plot two diagnostic plots relate equality variance (residuals vs fitted scale-location).three methods agree isn’t issues equality variance:Bartlett test p-value large non-significantthe spread points three groups residuals vs fitted graph roughly samethe red line scale-location graph pretty horizontalOverall, assumption pretty well met.5. Carry one-way ANOVAWith assumptions normality equality variance met can confident one-way ANOVA appropriate test.6. ResultA one-way ANOVA test indicated mean weight juvenile lobsters differ significantly diets (F = 1.64, df = 2,15, p = 0.23).7. Post-hoc testing TukeyHere can see actually, significant difference pairs groups dataset.want reiterate carrying post-hoc test getting non-significant result ANOVA something think carefully depends research question .research question :diet affect lobster weight? effect diet lobster weight?got non-significant result ANOVA test just stopped answer. Going digging “significant” results running tests main factor contributes towards lack reproducibility research.hand research question :specific diets better worse lobster weight others?probably just skipped one-way ANOVA test entirely just jumped straight Tukey’s range test, important point result one-way ANOVA test doesn’t preclude carrying Tukey test.","code":"\nlobsters <- read.csv(\"data/raw/CS2-lobsters.csv\")##    weight    diet\n## 1   151.6 Mussels\n## 2   132.1 Mussels\n## 3   104.2 Mussels\n## 4   153.5 Mussels\n## 5   132.0 Mussels\n## 6   119.0 Mussels\n## 7   161.9 Mussels\n## 8   117.7 Pellets\n## 9   110.8 Pellets\n## 10  128.6 Pellets\n## 11  110.1 Pellets\n## 12  175.2 Pellets\n## 13  101.8  Flakes\n## 14  102.9  Flakes\n## 15   90.4  Flakes\n## 16  132.8  Flakes\n## 17  129.3  Flakes\n## 18  129.4  Flakes\naggregate(weight ~ diet, data = lobsters, summary)##      diet weight.Min. weight.1st Qu. weight.Median weight.Mean weight.3rd Qu.\n## 1  Flakes     90.4000       102.0750      116.1000    114.4333       129.3750\n## 2 Mussels    104.2000       125.5000      132.1000    136.3286       152.5500\n## 3 Pellets    110.1000       110.8000      117.7000    128.4800       128.6000\n##   weight.Max.\n## 1    132.8000\n## 2    161.9000\n## 3    175.2000\nboxplot(weight ~ diet, data = lobsters)\nlobst_uns <- unstack(lobsters, weight ~ diet)\nshapiro.test(lobst_uns$Flakes)## \n##  Shapiro-Wilk normality test\n## \n## data:  lobst_uns$Flakes\n## W = 0.84368, p-value = 0.1398\nshapiro.test(lobst_uns$Mussels)## \n##  Shapiro-Wilk normality test\n## \n## data:  lobst_uns$Mussels\n## W = 0.94784, p-value = 0.71\nshapiro.test(lobst_uns$Pellets)## \n##  Shapiro-Wilk normality test\n## \n## data:  lobst_uns$Pellets\n## W = 0.76706, p-value = 0.0425\nresid_lobst <- residuals(lm(weight ~ diet, data = lobsters))\nshapiro.test(resid_lobst)## \n##  Shapiro-Wilk normality test\n## \n## data:  resid_lobst\n## W = 0.94779, p-value = 0.3914\nplot(lm(weight ~ diet , data = lobsters),\n     which = 2)\nbartlett.test(weight ~ diet, data = lobsters)## \n##  Bartlett test of homogeneity of variances\n## \n## data:  weight by diet\n## Bartlett's K-squared = 0.71273, df = 2, p-value = 0.7002\nplot(lm(weight ~ diet, data = lobsters),\n     which = c(1,3))\nanova(lm(weight ~ diet, data = lobsters))## Analysis of Variance Table\n## \n## Response: weight\n##           Df Sum Sq Mean Sq F value Pr(>F)\n## diet       2 1567.2  783.61  1.6432 0.2263\n## Residuals 15 7153.1  476.87\nTukeyHSD(aov(weight ~ diet, data = lobsters))##   Tukey multiple comparisons of means\n##     95% family-wise confidence level\n## \n## Fit: aov(formula = weight ~ diet, data = lobsters)\n## \n## $diet\n##                      diff        lwr      upr     p adj\n## Mussels-Flakes  21.895238  -9.661957 53.45243 0.2024851\n## Pellets-Flakes  14.046667 -20.300196 48.39353 0.5508657\n## Pellets-Mussels -7.848571 -41.061560 25.36442 0.8148766"},{"path":"cs2-anova.html","id":"key-points","chapter":"4 ANOVA","heading":"4.11 Key points","text":"Point 1Point 2Point 3","code":""}]
